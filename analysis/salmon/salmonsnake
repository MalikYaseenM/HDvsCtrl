include: '../common_workflow.snake'
workdir: '../../samples'


salmonpath='/projectnb/bubhub/bubhub-reference/genome/human/GENCODE/v25/gencode.v25.pc_lncRNA_transcri\
pts.salmon_quasi_index'

pathtogtf='/projectnb/bubhub/bubhub-reference/genome/human/GENCODE/v25/gencode.v25.annotation.gtf'

#quant = expand('{sample}__salmon__counts.quant.sf',sample=dataset_ids)
count = expand('{sample}__salmon__counts', sample=dataset_ids)

rule all:
  input:
    count


rule salmonquant:
    input:
      read1="{sample}__R1.fastq.gz",
      read2="{sample}__R2.fastq.gz",
      gtf= pathtogtf,
      index= salmonpath
    output:
      file='{sample}__salmon__counts'
#    params:
#      prefix='{sample}__salmon__counts.'
    threads: 8
    shell:
      "salmon quant --index {input.index} -g {input.gtf} "
      "-l A -1 {input.read1} -2 {input.read2} --output {output.file} "
      "-p {threads} "
